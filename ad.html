<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <title>Đang chuyển hướng...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background-color: #121212;
        color: #e0e0e0;
        text-align: center;
      }
      .container {
        padding: 20px;
      }
      h1 {
        font-size: 1.5rem;
        margin-bottom: 10px;
      }
      p {
        font-size: 1rem;
        color: #b0b0b0;
      }
      span {
        font-weight: bold;
        color: #ffffff;
        font-size: 1.2rem;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Đây là một trang quảng cáo</h1>
      <p>Bạn sẽ được chuyển hướng sau <span id="countdown">10</span> giây...</p>
    </div>
    <script>
      // Dùng JSON.stringify để đảm bảo link được truyền vào an toàn
      const adUrl = <?= JSON.stringify(adUrl) ?>;

      if (adUrl) {
        let count = 10;
        const countdownElement = document.getElementById('countdown');
        
        // Cập nhật bộ đếm mỗi giây
        const interval = setInterval(() => {
          count--;
          if (countdownElement) {
            countdownElement.innerText = count;
          }
          // Khi đếm về 0, chuyển hướng
          if (count <= 0) {
            clearInterval(interval);
            window.location.replace(adUrl);
          }
        }, 1000);
      } else {
        // Nếu không có link quảng cáo, hiển thị lỗi và tự đóng
        const container = document.querySelector('.container');
        if (container) {
          container.innerHTML = "<h1>Lỗi</h1><p>Không tìm thấy link quảng cáo. Cửa sổ này sẽ tự đóng.</p>";
        }
        setTimeout(() => {
          window.close();
        }, 3000);
      }
    </script>
  </body>
</html>