<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Share Zone - T√†i Nguy√™n Media Designer</title>
    <link rel="icon" href="https://raw.githubusercontent.com/dinhxuantuan-014/sheet/refs/heads/main/logo%20chuyen%20nghe%20media.ico" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
:root{--accent-red:#E54B4B;--accent-pink:#D972FF;--main-blue:#4A4AEB;--dark-blue:#3B3B9A;--border-color:#6A6ADF;--container-bg:rgba(45,45,120,0.8);--dark-bg:#2A2A72;--text-color:#F0F0FF;--subtle-text-color:#A0A0E0;--accent-gradient:linear-gradient(90deg,var(--main-blue),var(--accent-pink))}
*{box-sizing:border-box}
html,body{margin:0;padding:0;width:100%;height:100%;overflow:hidden}
body{font-family:'Montserrat',sans-serif;background-color:var(--dark-bg);color:var(--text-color);display:flex;justify-content:center;align-items:center;min-height:100vh;padding:20px}
#particle-canvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;pointer-events:none}
.container{background-color:var(--container-bg);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);padding:30px 40px;border-radius:12px;box-shadow:0 0 40px rgba(74,74,235,.4);border:1px solid var(--border-color);width:100%;max-width:800px;text-align:center;animation:fadeIn .6s ease-out forwards;max-height:90vh;overflow-y:auto;position:relative;z-index:1;will-change:opacity,transform}
@keyframes fadeIn{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
.main-title{font-size:2.8rem;font-weight:700;background:var(--accent-gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin:0 0 20px;line-height:1.2}
.social-links{margin-bottom:30px;border-bottom:1px solid var(--border-color);padding-bottom:30px;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:15px}
.social-links a{background-color:rgba(74,74,235,.2);color:var(--text-color);padding:8px 15px;border-radius:20px;text-decoration:none;font-size:.9rem;transition:all .2s ease;will-change:transform}
.social-links a:hover{background:var(--accent-gradient);color:#FFF;transform:translateY(-3px);box-shadow:0 4px 15px rgba(217,114,255,.4)}
.search-wrapper{display:flex;gap:10px;margin-bottom:15px}
#searchInput{flex-grow:1;padding:12px 15px;background-color:var(--dark-bg);border:1px solid var(--border-color);border-radius:8px;font-size:1rem;color:var(--text-color);transition:border-color .2s ease}
#searchInput:focus{outline:none;border-color:var(--main-blue);box-shadow:0 0 10px rgba(74,74,235,.5)}
#searchButton{padding:12px 25px;background:var(--accent-red);color:#FFF;border:none;border-radius:8px;cursor:pointer;font-size:1rem;font-weight:700;transition:all .2s ease;will-change:transform}
#searchButton:hover:not(:disabled){transform:translateY(-3px);box-shadow:0 4px 20px rgba(229,75,75,.6)}
#searchButton:disabled{opacity:.6;cursor:not-allowed}
#status{min-height:20px;font-style:italic;color:var(--subtle-text-color);margin:10px 0}
#results{margin-top:30px;text-align:left;border-top:1px solid var(--border-color);padding-top:30px}
#result-title{font-size:2rem;color:var(--text-color);background:var(--accent-gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin:0 0 25px}
#results h3{margin-top:25px;color:var(--subtle-text-color);font-weight:400;border-bottom:1px solid var(--border-color);padding-bottom:10px}
.result-list{list-style-type:none;padding-left:0;margin:0}
.result-list li{background:rgba(42,42,114,.8);margin-bottom:10px;padding:15px;border-radius:8px;border-left:4px solid var(--border-color);word-wrap:break-word;font-size:.95rem;display:flex;align-items:center;gap:12px;transition:all .2s ease;will-change:transform}
.result-list li:hover{border-left-color:var(--accent-pink);transform:translateX(5px)}
.result-list a{color:var(--text-color);text-decoration:none;transition:color .2s;display:block;width:100%;cursor:pointer}
.result-list a:hover{color:var(--subtle-text-color)}
.popup-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:1000;justify-content:center;align-items:center;animation:fadeInOverlay .3s ease}
@keyframes fadeInOverlay{from{opacity:0}to{opacity:1}}
.popup-content{background:var(--container-bg);backdrop-filter:blur(10px);padding:30px;border-radius:12px;box-shadow:0 0 50px rgba(74,74,235,.6);border:2px solid var(--border-color);max-width:500px;width:90%;text-align:center;animation:slideIn .3s ease}
@keyframes slideIn{from{transform:translateY(-50px);opacity:0}to{transform:translateY(0);opacity:1}}
.popup-content h2{color:var(--text-color);margin-top:0;background:var(--accent-gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.popup-content p{color:var(--subtle-text-color);margin:20px 0;font-size:1.1rem;line-height:1.6}
.popup-buttons{display:flex;gap:15px;justify-content:center;margin-top:25px}
.popup-btn{padding:12px 30px;border:none;border-radius:8px;font-size:1rem;font-weight:700;cursor:pointer;transition:all .2s ease;will-change:transform}
.popup-btn-primary{background:var(--accent-gradient);color:#FFF}
.popup-btn-primary:hover{transform:translateY(-3px);box-shadow:0 4px 20px rgba(217,114,255,.6)}
.popup-btn-secondary{background:rgba(74,74,235,.2);color:var(--text-color)}
.popup-btn-secondary:hover{background:rgba(74,74,235,.4)}
@media (max-width:600px){
body{padding:0;align-items:stretch}
.container{padding:20px 15px;border-radius:0;border:none;height:100%;max-height:100vh;box-shadow:none}
.main-title{font-size:2.2rem}
.search-wrapper{flex-direction:column}
.popup-content{padding:20px;width:85%}
.popup-buttons{flex-direction:column}
}
    </style>
</head>
<body>
    <canvas id="particle-canvas"></canvas>
    
    <div id="popup" class="popup-overlay">
        <div class="popup-content">
            <h2>üéâ Th√¥ng B√°o</h2>
            <p id="popup-message">ƒêang t·∫£i...</p>
            <div class="popup-buttons">
                <button class="popup-btn popup-btn-primary" id="popup-visit">Truy C·∫≠p Link</button>
                <button class="popup-btn popup-btn-secondary" id="popup-close">ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <div class="container">
        <h1 class="main-title">Chuy·ªán ngh·ªÅ Media</h1>
        <div class="social-links">
          <a href="https://www.facebook.com/groups/chuyennghemedia/" target="_blank" rel="noopener">Facebook Group</a>
          <a href="https://discord.gg/vM8cnmxwfs" target="_blank" rel="noopener">Discord</a>
          <a href="https://t.me/chuyennghemedia/" target="_blank" rel="noopener">Telegram</a>
          <a href="https://zalo.me/g/monpsz855" target="_blank" rel="noopener">Zalo Group</a>
        </div>
        <div class="search-wrapper">
            <input type="text" id="searchInput" placeholder="Nh·∫≠p code v√†o ƒë√¢y..." autocomplete="off">
            <button id="searchButton">T√¨m Ki·∫øm</button>
        </div>
        <div id="status"></div>
        <div id="results" style="display:none;">
            <h2 id="result-title"></h2>
            <div id="password-section" style="display:none">
                <h3>M·∫≠t Kh·∫©u:</h3>
                <ul id="password-list" class="result-list"></ul>
            </div>
            <div id="note-section" style="display:none">
                <h3>Ghi Ch√∫:</h3>
                <ul id="note-list" class="result-list"></ul>
            </div>
            <h3>Link Download</h3>
            <ul id="link-list" class="result-list"></ul>
        </div>
    </div>

    <script>
      const _0x4a2b=['aHR0cHM6Ly9zY3JpcHQuZ29vZ2xlLmNvbS9tYWNyb3Mvcy9BS2Z5Y2J6bE1IdXdMS2MxZGdqeEJqNFAzZ1BkbjZkNlRQeVFrdHk4NE0yWjVyUWxsQzhZYUJNRFV5Ty10V1E4bHgzX1d3NXgvZXhlYw==','MUhoNVA0UTJpeWg5b3RVUkRGQk9fSURUeWJSU18wWko0SnFlOFdGei16OA=='];
      const _0x1d4c=s=>atob(s);
      const API=_0x1d4c(_0x4a2b[0]);
      const SID=_0x1d4c(_0x4a2b[1]);
      
      let cache={ads:[],timestamp:0};
      let dlLink='';
      const CACHE_TIME=3e5;
      
      // Debounce helper
      const debounce=(fn,delay)=>{
        let timer;
        return function(...args){
          clearTimeout(timer);
          timer=setTimeout(()=>fn.apply(this,args),delay);
        };
      };
      
      // Kh·ªüi t·∫°o - preload ads ngay
      (async()=>{
        loadAds(); // Load async kh√¥ng ch·ªù
        const p=location.pathname;
        if(p.length>1){
          const c=p.substring(1);
          if(/^\d+$/.test(c)){
            const inp=document.getElementById('searchInput');
            inp.value=c;
            // Kh√¥ng auto focus ƒë·ªÉ tr√°nh keyboard popup tr√™n mobile
          }
        }
      })();

      // Load qu·∫£ng c√°o - optimized
      async function loadAds(){
        const now=Date.now();
        if(cache.ads.length&&(now-cache.timestamp)<CACHE_TIME)return;
        
        try{
          const res=await fetch(`${API}?action=getAds`,{
            method:'GET',
            cache:'force-cache' // S·ª≠ d·ª•ng browser cache
          });
          if(!res.ok)throw new Error(`HTTP ${res.status}`);
          const d=await res.json();
          
          if(d.ads&&Array.isArray(d.ads)){
            cache.ads=d.ads;
            cache.timestamp=now;
          }
        }catch(e){
          console.error('Ads load error:',e);
          if(!cache.ads.length)cache.ads=[]; // Ch·ªâ reset n·∫øu ch∆∞a c√≥ data
        }
      }

      const getRandAd=()=>cache.ads.length?cache.ads[Math.floor(Math.random()*cache.ads.length)]:null;

      function showPop(link){
        const ad=getRandAd();
        if(!ad){
          window.open(link,'_blank','noopener,noreferrer');
          return;
        }

        dlLink=link;
        const pop=document.getElementById('popup');
        const msg=document.getElementById('popup-message');
        
        msg.textContent=ad.title;
        pop.style.display='flex';

        const visit=document.getElementById('popup-visit');
        const close=document.getElementById('popup-close');
        
        const openLinks=()=>{
          window.open(ad.link,'_blank','noopener,noreferrer');
          window.open(dlLink,'_blank','noopener,noreferrer');
          pop.style.display='none';
        };
        
        const closeOnly=()=>{
          window.open(dlLink,'_blank','noopener,noreferrer');
          pop.style.display='none';
        };
        
        visit.onclick=openLinks;
        close.onclick=closeOnly;
      }

      // Search handler - OPTIMIZED
      const inp=document.getElementById('searchInput');
      const btn=document.getElementById('searchButton');
      
      // Ch·ªâ listen Enter key, kh√¥ng x·ª≠ l√Ω m·ªçi keyup
      inp.addEventListener('keydown',e=>{
        if(e.key==='Enter'){
          e.preventDefault();
          search();
        }
      });
      
      btn.addEventListener('click',search);

      // Prevent multiple simultaneous searches
      let isSearching=false;

      async function search(){
        if(isSearching)return;
        
        const code=inp.value.trim();
        const stat=document.getElementById('status');
        const res=document.getElementById('results');
        
        if(!code){
          stat.innerText="Vui l√≤ng nh·∫≠p code.";
          return;
        }
        
        isSearching=true;
        stat.innerText="ƒêang t√¨m ki·∫øm...";
        btn.disabled=true;
        res.style.display='none';
        
        try{
          const resp=await fetch(`${API}?action=search&code=${encodeURIComponent(code)}`,{
            method:'GET',
            cache:'no-store'
          });
          if(!resp.ok)throw new Error(`L·ªói ${resp.statusText}`);
          const data=await resp.json();
          display(data);
        }catch(e){
          stat.innerText="L·ªói: "+e.message;
        }finally{
          btn.disabled=false;
          isSearching=false;
        }
      }
      
      function display(d){
        const stat=document.getElementById('status');
        const res=document.getElementById('results');
        
        if(d.error){
          stat.innerText=d.error;
          res.style.display='none';
          return;
        }
        
        stat.innerText="";
        document.getElementById('result-title').innerText=d.title;
        
        // Password
        const pwSec=document.getElementById('password-section');
        const pwList=document.getElementById('password-list');
        pwList.innerHTML='';
        if(d.passwords?.length){
          const frag=document.createDocumentFragment();
          d.passwords.forEach(p=>{
            const li=document.createElement('li');
            li.textContent=p;
            frag.appendChild(li);
          });
          pwList.appendChild(frag);
          pwSec.style.display='block';
        }else{
          pwSec.style.display='none';
        }
        
        // Notes
        const noteSec=document.getElementById('note-section');
        const noteList=document.getElementById('note-list');
        noteList.innerHTML='';
        if(d.notes?.length){
          const frag=document.createDocumentFragment();
          d.notes.forEach(n=>{
            const li=document.createElement('li');
            li.textContent=n;
            frag.appendChild(li);
          });
          noteList.appendChild(frag);
          noteSec.style.display='block';
        }else{
          noteSec.style.display='none';
        }
        
        // Links
        const linkList=document.getElementById('link-list');
        linkList.innerHTML='';
        if(d.links?.length){
          const frag=document.createDocumentFragment();
          d.links.forEach(link=>{
            const li=document.createElement('li');
            const a=document.createElement('a');
            a.href='javascript:void(0)';
            a.textContent=getLinkTxt(link);
            a.onclick=e=>{
              e.preventDefault();
              showPop(link);
            };
            li.appendChild(a);
            frag.appendChild(li);
          });
          linkList.appendChild(frag);
        }else{
          const li=document.createElement('li');
          li.textContent='Kh√¥ng c√≥ link download.';
          linkList.appendChild(li);
        }
        
        res.style.display='block';
      }
      
      function getLinkTxt(url){
        const u=url.toLowerCase();
        const map={
          'drive.google.com':'Link Google Drive',
          'photos.app.goo.gl':'Link Google Photo',
          'fshare.vn':'Link Fshare',
          'mega.nz':'Link Mega',
          'mediafire.com':'Link MediaFire',
          'terabox.com':'Link Terabox',
          't.me':'Link Telegram',
          'telegram':'Link Telegram',
          'dropbox.com':'Link Dropbox',
          'usersdrive.com':'Link UsersDrive'
        };
        
        for(const[k,v]of Object.entries(map)){
          if(u.includes(k))return v;
        }
        return 'Link Download';
      }
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.12.0/tsparticles.bundle.min.js"></script>
    <script>
      // Lazy load particles sau khi page load xong
      window.addEventListener('load',()=>{
        setTimeout(()=>{
          tsParticles.load("particle-canvas",{
            fpsLimit:60,
            particles:{
              number:{value:40,density:{enable:!0,value_area:800}}, // Gi·∫£m s·ªë particles
              color:{value:"#A0A0E0"},
              shape:{type:"circle"},
              opacity:{value:.5,random:!0},
              size:{value:{min:1,max:3}},
              links:{enable:!0,distance:150,color:"#6A6ADF",opacity:.4,width:1},
              move:{enable:!0,speed:1,direction:"none",out_mode:"out"} // Gi·∫£m speed
            },
            interactivity:{
              detect_on:"canvas",
              events:{
                onhover:{enable:!0,mode:"repulse"},
                resize:!0
              },
              modes:{repulse:{distance:150,duration:.3}} // Gi·∫£m distance v√† duration
            },
            detectRetina:!0
          });
        },500); // Delay 500ms ƒë·ªÉ trang load xong
      });
    </script>
</body>
</html>
